---
title: "The PSTricks for R Package"
author: "Erik Olofsen"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output:
  bookdown::pdf_document2:
    number_sections: true
    latex_engine: pdflatex
    keep_tex: false
  bookdown::html_document2:
    number_sections: true
    fig_retina: NULL
documentclass: book
papersize: a4
fontsize: 12pt
fontfamily: tgpagella
geometry: margin=1.5cm
link-citations: yes
linkcolor: "blue"
github-repo: rstudio/bookdown-demo
description: " PSTricks provides R bindings for LaTeX's PSTricks package, higher level plot commands, the capability of generating a complete .tex file, and compiling it to a .pdf file"
---

```{r, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# About the Package PSTricks

The package "PSTricks" provides layers above the PSTricks macro
package for LaTeX (https://tug.org/PSTricks/main.cgi)
by implementing wrapper functions for the macros.
The advantage of these wrapper functions is that the arguments can be
created with R functions, especially obviously the data. The second
advantage is that everything is under your control; graphics are not
determined by R's base plotting routines or by for example the "ggplot2" package,
which have quite complicated mechanics and the default output may be
difficult to change. A third advantage is that when using LaTeX, the
fonts used in the graphs are easier to match those in the text.

For the main package there are the two manuals (the original
"pst-user.pdf" and "pstricks-doc.pdf"), there are manuals for additional
packages, and there is the book by Herbert Vo\ss. Furthermore, there
are chapters dedicated to it in the book "The LaTeX Graphics Companion".
Finally, there is information on Wikipedia:
https://en.wikipedia.org/wiki/PSTricks .

"tikz" would be an alternative. The package "tikzDevice" outputs TeX code,
but does not provide wrappers for the tikz language;
interfacing with the tikz syntax might be difficult to match with elegance.

The present interface consists of R function calls which are not too
different from the macro calls; but unfortunately the nice PSTricks
syntax with parentheses, brackets, and curly braces is unavoidably lost.

Mainly the main PSTricks macros, where the original manual
served as the main guide (also for examples), have been layered at present. Adding
functions for additional packages is not difficult; adding
documentation and tests takes most of the effort (see the last
section of this chapter).

The default output of an R script with PSTricks calls is a .pdf,
generated by calling a LaTeX engine and cleaning up automatically.

## Higher level functions

Functions have been added to produce plots. The first letters of the
function names are usually "pp" to differentiate them from the
PSTricks macro names which usually start with "ps". "pp" was chosen
because the function names of the "ggplot2" package also usually
start with two indentical letters. Here it could indicate that it is a
second layer above the PostScript language. Also many functions
starting with "geom_" have been added which a similar, but not
completely identical, functionality as those in "ggplot2", see
Chapter \@ref(geoms).

## Installation

The package may be installed as usual, for example in the following two ways.

* devtools

In the directory where PSTricks_0.1.0.tar.gz (or a later version) has been untarred, within R:

```{r eval=FALSE}
install.packages("devtools")
devtools::install(build_vignettes=TRUE)
```
Building the vignettes needs a working system with LaTeX and "pandoc",
so if that is not (yet) the case `build_vignettes=FALSE` (the default)
may be useful.

* handling the dependencies by hand
```{bash eval=FALSE}
R CMD INSTALL PSTricks_0.1.0.tar.gz
```
This will generate messages about additional R packages that need to be installed.

### System packages
The following system packages need to be installed:

- texlive-latex-base
- texlive-pstricks
- texlive-xelatex if the "xelatex" engine is desired
- pandoc

## The configuration file

Overrides for defaults may be given, in a file "~/pstricks.yml", for

- engine
- paper
- packages
- pstpkgs
- familydefault
- tmpdir

These may be likely to have relatively stable values across various
scripts for a project.

The file is load using the "rconfig" package.
If the environment variable "R_RCONFIG_FILE" is used, it will
override the default "~/pstricks.yml".

For example, the sample "pstricks.yml" contains
```
engine: pdflatex
packages: tgheros
```

See the documentation of the `PSTricks()` function for the available settings.

Four engines may be used, "latex", "pdflatex", "xelatex", and "lualatex".
The outputs of the engines are not identical. There is a script "examples/engines.R"
to test the engines, in particular the handling of opacity.

## Using the library

The library is loaded as usual:
```{r setup}
library(PSTricks)
```

## Examples, vignette, and tests

The packages comes with default documentation of all functions.
The vignette provides a first look and serve as a test during "R CMD check",
and is included as the next chapter.
Many examples in the source files also function tests during the check.
(see Chapter \@ref(example-files)).
With the "testthat" tests mostly the lower level functions are tested.

## Extending for unlayered macro packages

If a macro has not been wrapped, a new function may be added where
`ppbuild()` is the main building block:

```{r}
ppbuild("psbuild",1,2,"opt","arg","arg1","arg2","arg3","arg4","arg0",TRUE)
```

A version for 3D plotting is available although 3D plotting is otherwise not implemented:

```{r}
ppbuild3D("psbuild",1,2,3,"opt","arg","arg1","arg2","arg3","arg4","arg0",TRUE)
```

See "examples/3d.R" for an example on how this can be done.

See also functions like `pparg()`, `ppopt()`, and `ppcoords()` that construct macro parts.

